# Configuration Netlify pour Luméa Communication

[build]
  # Pas de build nécessaire, site statique
  publish = "."

[build.processing]
  skip_processing = false

[build.processing.css]
  bundle = false
  minify = true

[build.processing.js]
  bundle = false
  minify = true

[build.processing.html]
  pretty_urls = true

# Redirections pour les dossiers de pays (sans slash final)
[[redirects]]
  from = "/ch"
  to = "/ch/"
  status = 301

[[redirects]]
  from = "/fr"
  to = "/fr/"
  status = 301

[[redirects]]
  from = "/es"
  to = "/es/"
  status = 301

# Redirections basées sur le domaine
# IMPORTANT: Remplacez "lumea.ch", "lumea.fr", "lumea.es" par vos vrais domaines
# 
# Si vous avez trois domaines différents, Netlify redirigera automatiquement
# vers la bonne version selon le domaine utilisé par le visiteur

# Pour le domaine CH - Redirige vers /ch/
# Remplacez "lumea.ch" par votre vrai domaine CH
[[redirects]]
  from = "/*"
  to = "/ch/:splat"
  status = 200
  force = false
  conditions = {Host = "lumea.ch"}

[[redirects]]
  from = "/*"
  to = "/ch/:splat"
  status = 200
  force = false
  conditions = {Host = "www.lumea.ch"}

# Pour le domaine FR - Redirige vers /fr/
# Remplacez "lumea.fr" par votre vrai domaine FR
[[redirects]]
  from = "/*"
  to = "/fr/:splat"
  status = 200
  force = false
  conditions = {Host = "lumea.fr"}

[[redirects]]
  from = "/*"
  to = "/fr/:splat"
  status = 200
  force = false
  conditions = {Host = "www.lumea.fr"}

# Pour le domaine ES - Redirige vers /es/
# Remplacez "lumea.es" par votre vrai domaine ES
[[redirects]]
  from = "/*"
  to = "/es/:splat"
  status = 200
  force = false
  conditions = {Host = "lumea.es"}

[[redirects]]
  from = "/*"
  to = "/es/:splat"
  status = 200
  force = false
  conditions = {Host = "www.lumea.es"}

# Note: Si aucun domaine spécifique ne correspond, 
# Netlify affichera index.html (sélecteur de pays) par défaut

# Headers de sécurité
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1; mode=block"
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"
    Permissions-Policy = "geolocation=(), microphone=(), camera=()"

# Headers pour les assets statiques (cache)
[[headers]]
  for = "/assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Headers pour les images
[[headers]]
  for = "/assets/img/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Headers pour le CSS et JS
[[headers]]
  for = "/assets/css/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/assets/js/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Headers pour les fichiers HTML (pas de cache pour faciliter les mises à jour)
[[headers]]
  for = "/*.html"
  [headers.values]
    Cache-Control = "public, max-age=0, must-revalidate"

# Configuration pour les formulaires Netlify (optionnel, si vous voulez remplacer EmailJS)
# [forms]
#   name = "contact-form"
