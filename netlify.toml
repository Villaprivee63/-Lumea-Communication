# Configuration Netlify pour Luméa Communication

[build]
  # Pas de build nécessaire, site statique
  publish = "."

[build.processing]
  skip_processing = false

[build.processing.css]
  bundle = false
  minify = true

[build.processing.js]
  bundle = false
  minify = true

[build.processing.html]
  pretty_urls = true

# Redirections pour les dossiers de pays (sans slash final)
[[redirects]]
  from = "/ch"
  to = "/ch/"
  status = 301

[[redirects]]
  from = "/fr"
  to = "/fr/"
  status = 301

[[redirects]]
  from = "/es"
  to = "/es/"
  status = 301

# Redirections basées sur le domaine
# Configuration pour les domaines : lumeacommunication.ch, lumeacommunication.fr
# Le domaine .es sera ajouté plus tard

# IMPORTANT: Les assets (CSS, JS, images) ne doivent PAS être redirigés
# Ils restent à la racine (assets/) et sont accessibles depuis tous les domaines

# Pour le domaine CH - Redirige uniquement la racine vers /ch/
# Les autres pages et assets ne sont pas redirigés
[[redirects]]
  from = "https://lumeacommunication.ch/"
  to = "/ch/"
  status = 301
  force = false

[[redirects]]
  from = "https://www.lumeacommunication.ch/"
  to = "/ch/"
  status = 301
  force = false

# Pour le domaine FR - Redirige uniquement la racine vers /fr/
[[redirects]]
  from = "https://lumeacommunication.fr/"
  to = "/fr/"
  status = 301
  force = false

[[redirects]]
  from = "https://www.lumeacommunication.fr/"
  to = "/fr/"
  status = 301
  force = false

# Pour le domaine ES - Redirige vers /es/ (à activer quand le domaine sera acheté)
# [[redirects]]
#   from = "/*"
#   to = "/es/:splat"
#   status = 200
#   force = false
#   conditions = {Host = "lumeacommunication.es"}
#
# [[redirects]]
#   from = "/*"
#   to = "/es/:splat"
#   status = 200
#   force = false
#   conditions = {Host = "www.lumeacommunication.es"}

# Note: Si aucun domaine spécifique ne correspond, 
# Netlify affichera index.html (sélecteur de pays) par défaut

# Headers de sécurité
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1; mode=block"
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"
    Permissions-Policy = "geolocation=(), microphone=(), camera=()"

# Headers pour les assets statiques (cache)
[[headers]]
  for = "/assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Headers pour les images
[[headers]]
  for = "/assets/img/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Headers pour le CSS et JS
[[headers]]
  for = "/assets/css/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/assets/js/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Headers pour les fichiers HTML (pas de cache pour faciliter les mises à jour)
[[headers]]
  for = "/*.html"
  [headers.values]
    Cache-Control = "public, max-age=0, must-revalidate"

# Configuration pour les formulaires Netlify (optionnel, si vous voulez remplacer EmailJS)
# [forms]
#   name = "contact-form"
